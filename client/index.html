<!DOCTYPE html>
<html>
  <head>
    <title>Back End Assessment</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body class="container">
    <button id="complimentButton">Get a compliment</button>
    <button id="fortuneButton">Get a fortune</button>
    <button id="positiveWordButton">Get a nice word</button>
    <button id="picButton">Get pic</button>
    <div id="picOutput">
    <p id="picContainer"></p>
    </div>
    <form>
      <h2>Goals</h2>
      <input type="text" id="addGoal" name="addGoal" placeholder="Add a new goal">
      <input type="submit" id="submit" name="submit" value="Submit">
    </form>
      <ul id="goalsList"></ul>
    <section id="quoteContainer">
      <h2>Seclect A Quote</h2>
      <select id="quoteList" name="quoteList">
        <option>Brown</option>
        <option>Whitman</option>
        <option>Lombardi</option>
      </select>
      <div id="quoteOutput"></div>
    </section>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      document.getElementById("complimentButton").onclick = function () {
        axios.get("http://localhost:4000/api/compliment/")
            .then(function (response) {
              const data = response.data;
              alert(data);
            });
      };
      document.getElementById("fortuneButton").onclick = function () {
        axios.get("http://localhost:4000/api/fortune")
          .then(function (response) {
            const data = response.data;
            alert(data);
          })
          .catch(err => console.log(err))
      };
      document.getElementById("positiveWordButton").onclick = function () {
        axios.get("http://localhost:4000/api/words")
          .then(function (response) {
            const data = response.data;
            alert(data);
          })
          .catch(err => console.log(err))
      };

      const form = document.querySelector("form");
      const addGoal = document.querySelector("#addGoal");
      const goalsList = document.querySelector("#goalsList")
      let goalID = 0

      function submitHandler(e) {
        e.preventDefault();
        let goalObj = {
          id: goalID,
          goal: addGoal.value
        };
        goalID++
        axios.post("http://localhost:4000/api/goals", goalObj)
          .then(constructList)
          .catch(err => console.log(err))

        addGoal.value = "";
      }
      form.addEventListener("submit", submitHandler);

      function deleteGoalItem(event) {
        const deleteButtonID = +event.target.id
        axios.delete(`http://localhost:4000/api/goals/${deleteButtonID}`)
          .then(constructList)
          .catch(err => console.log(err))
      }

      const constructList = (res) => {
        let goals = res.data
        goalsList.innerHTML = null;
        console.log(res.data)
        for(let i = 0; i < goals.length; i++) {
          const listItem = document.createElement("li");
          const deleteButton = document.createElement("button");
          deleteButton.innerText = "-";
          deleteButton.classList.add("deleteButtons");
          deleteButton.id = +goals[i].id
          deleteButton.addEventListener("click", deleteGoalItem)
          listItem.classList.add("goalListItem");
          listItem.innerText = goals[i].goal;
          listItem.appendChild(deleteButton);
          goalsList.appendChild(listItem);
        }
      }
      // let deleteButtons = document.querySelectorAll(".deleteButtons");
      // for(let i = 0; i < deleteButtons.length; i++) {
      //   i.addEventListener("click", deleteGoalItem);
      // }
      


      const quoteList = document.querySelector("#quoteList");
      const quoteOutput = document.querySelector("#quoteOutput");
      function quoteHandler(e) {
        quoteOutput.innerText = "";
        let person = event.target.value
        axios.get("http://localhost:4000/api/quotes")
          .then(res => {
            const quoteObj = res.data;
            for(let q in quoteObj) {
              if(q === person) {
                const quoteBlock = document.createElement("p");
                quoteBlock.innerText = quoteObj[q];
                quoteOutput.appendChild(quoteBlock);
              }
            }
          })
          .catch(err => console.log(err))
      }
      quoteList.addEventListener("change", quoteHandler);
      const picButton = document.querySelector("#picButton");
      let picContainer = document.querySelector("#picContainer");
      function addPic() {
        axios.get("http://localhost:4000/api/pics")
          .then(res => {
            picContainer.innerHTML = "";
            let randomImage = res.data;
            let newImage = document.createElement("img");
            newImage.setAttribute("src", randomImage);
            picContainer.appendChild(newImage);
          })
          .catch(err => console.log(err))
      };
      picButton.addEventListener("click", addPic);
    </script>
  </body>
</html>
